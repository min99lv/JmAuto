<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.oracle.jmAuto.dto.Mapper.admin">

	<select id="selectUserList" resultType="User_Table">
		select *
		from User_Table
	</select>

	<update id="userDeactive" parameterType="String">
		update user_table
		set del_state = 1
		where user_id = #{user_id}
	</update>

	<update id="userActive" parameterType="String">
		update user_table
		set del_state = 0
		where user_id = #{user_id}
	</update>

	<select id="selectApprovalUserList" resultType="User_Table">
		select *
		from User_Table
		where approval = '0'
	</select>

	<update id="userApprove" parameterType="String">
		update user_table
		set approval = '1'
		where user_id = #{user_id}
	</update>


	<select id="userDetail" parameterType="String"
		resultType="AllUser_Info">
		SELECT
		u.user_id,
		u.user_name,
		u.user_type,
		u.buz_num,
		u.cert_num,
		u.approval,
		b.buz_name,
		b.buz_addr,
		b.buz_url,
		c.cert_name,
		c.cert_loc,
		c.cert_date,
		c.cert_url
		FROM
		user_table u
		LEFT JOIN
		business b ON u.buz_num = b.buz_num
		LEFT JOIN
		certified c ON u.cert_num = c.cert_num
		WHERE
		u.user_id = #{user_id}
	</select>


	<insert id="createManager" parameterType="User_Table">
		INSERT INTO USER_TABLE
		(user_id,user_pw,user_name,user_email,user_tel,user_type,del_state,approval)
		VALUES (#{user_id},#{user_pw},#{user_name},#{user_email},#{user_tel},#{user_type},#{del_state},#{approval})
	</insert>

<select id="searchUserList" parameterType="String" resultType="User_Table">
    SELECT *
    FROM user_table
    WHERE user_name LIKE '%' || #{keyword} || '%'
       OR user_id LIKE '%' || #{keyword} || '%'
</select>

</mapper> 